# PROMPT MAESTRO PARA COPILOT - Proyecto AHCS (Adaptive Huffman Suite)

## CONTEXTO GENERAL DEL PROYECTO

Estoy desarrollando **Adaptive Huffman Compression Suite (AHCS)**, un sistema educativo de compresi√≥n de datos basado en el **Algoritmo de Vitter (Adaptive Huffman Coding)**.

**Tecnolog√≠a Stack:**
- Backend: Node.js + Express.js (ES6 modules)
- Frontend: HTML5 + CSS3 + Vanilla JavaScript + D3.js
- Prop√≥sito: Proyecto acad√©mico (entrega 9 Nov, presentaci√≥n 10 Nov)

**Mi situaci√≥n actual:**
- ‚úÖ Core implementado: `VitterTree.js`, `VitterEncoder.js`, `VitterDecoder.js`, `SourceAnalyzer.js`
- ‚úÖ Todos los modelos testeados y validados
- üîÑ AHORA: Construyendo capas de aplicaci√≥n (Backend API ‚Üí Frontend ‚Üí Experimentos)

---

## INSTRUCCIONES GENERALES PARA CUALQUIER C√ìDIGO QUE GENERES

### 1. ESTILO Y CONVENCIONES
- **Formato:** ES6 modules (`import`/`export`)
- **Indentaci√≥n:** 2 espacios
- **Naming:** 
  - Clases: PascalCase (`VitterEncoder`, `CompressionController`)
  - Funciones/m√©todos: camelCase (`encodeSymbol`, `handleCompress`)
  - Constantes: UPPER_SNAKE_CASE (`MAX_PAYLOAD_SIZE`, `ALPHABET_SIZE`)
  - Privados: Prefijo `_` (ej: `_updateNode()`)
- **Punto y coma:** Siempre incluir
- **Comillas:** Simples (`'`) para strings cortos, template literals (`` ` ``) para interpolaci√≥n

### 2. COMENTARIOS Y DOCUMENTACI√ìN
- **JSDoc para funciones p√∫blicas:** Incluir descripci√≥n, par√°metros, retorno
- **Comentarios inline:** Solo para l√≥gica compleja (algoritmo Vitter, c√°lculos)
- **No comentar:** C√≥digo obvio o nombres autoexplicativos
- **Referencias acad√©micas:** Si usas f√≥rmulas matem√°ticas, cita: `// Shannon entropy: H(X) = -Œ£ P(x)*log2(P(x))`

### 3. MANEJO DE ERRORES
- **Try-catch:** Solo para errores inesperados (I/O, parsing)
- **Validaci√≥n de input:** Al inicio de cada funci√≥n
- **Errores descriptivos:** Incluir contexto (ej: "Cannot encode: input exceeds 1MB limit")
- **Logging:** Usar `logger` para debugging, no `console.log`

### 4. RENDIMIENTO
- **NO optimizar prematuramente**
- **S√≠ validar:** Que m√©todos no hagan loops innecesarios
- **Strings vs Buffers:** Usa strings para bits ("010101"), buffers solo si necesitas comprimirlos realmente
- **Memory:** No guarda todas las instancias de VitterTree, reutiliza en sesiones

### 5. TESTING IMPL√çCITO
- Asume que el c√≥digo ser√° testeado inmediatamente
- Incluye valores por defecto sensatos
- Si hay m√∫ltiples caminos, haz ambos v√°lidos
- Retorna objetos estructurados (no undefined sorpresas)

### 6. INTEGRACI√ìN CON MODELOS EXISTENTES
Tu c√≥digo **SIEMPRE** debe reutilizar estos m√≥dulos ya implementados:

```javascript
import VitterEncoder from '../models/VitterEncoder.js';
import VitterDecoder from '../models/VitterDecoder.js';
import SourceAnalyzer from '../models/SourceAnalyzer.js';
import logger from '../utils/logger.js';
```

**NO reimplementes:**
- C√°lculos de entrop√≠a
- Manejo de buffers
- Construcci√≥n del √°rbol Vitter

---

## PATR√ìN DE RESPUESTA PARA CADA ARCHIVO

Cuando pidas c√≥digo para un archivo espec√≠fico, adjunta este contexto:

```
ARCHIVO: [ruta/nombre.js]

PROP√ìSITO: [descripci√≥n de qu√© hace]

DEPENDENCIAS:
- Import: [m√≥dulos que necesita]
- Expone: [funciones/clases que exporta]

REQUISITOS FUNCIONALES:
- [Requisito 1]
- [Requisito 2]

EJEMPLO DE USO:
[C√≥digo que muestra c√≥mo se usa]

PAR√ÅMETROS/TIPOS:
- input: [tipo/formato]
- output: [tipo/formato]

NOTAS ESPECIALES:
[Restricciones, casos edge, decisiones de dise√±o]
```

---

## REGLAS ESPEC√çFICAS POR TIPO DE ARCHIVO

### PARA CONTROLLERS
```
- M√©todo por endpoint (ej: compress(), decompress())
- Estructura: validar input ‚Üí llamar modelo ‚Üí preparar respuesta
- Siempre retornar JSON con: { success: bool, data: {...}, error: string }
- Usar try-catch solo para errores inesperados
- Logging: log input (no sensible), output (solo tama√±o/tipo)
```

### PARA RUTAS (Routes)
```
- Una ruta por endpoint l√≥gico
- Usar express.Router()
- Agregar validaci√≥n de Content-Type
- L√≠mite de body size: 5MB
- Todas las rutas deben estar documentadas con su prop√≥sito
```

### PARA VISTAS (HTML)
```
- Estructura sem√°ntica (HTML5)
- Clases CSS descriptivas (no gen√©ricas como "container1")
- IDs solo para JavaScript targeting
- Responsive: mobile-first, breakpoint en 768px
- Sin inline styles (todo en CSS)
- Accesibilidad: aria-labels donde sea necesario
```

### PARA JAVASCRIPT DEL CLIENTE
```
- Separar l√≥gica de UI
- Usar fetch() para API calls
- Manejar errores de red (timeout, 500, etc.)
- Events: usar addEventListener (no onclick inline)
- DOM: usar document.querySelector/querySelectorAll
- No jQuery, solo vanilla JS
```

### PARA CSS
```
- Variables CSS para colores/tama√±os (:root { --primary: ... })
- Mobile-first media queries
- Flexbox/Grid, no floats
- Animaciones: usar @keyframes, no JavaScript
- Comentarios: secciones principales /* === Header === */
- OOCSS: clases reutilizables (utility classes)
```

---

## TEMPLATE DE PROMPT PARA COPILOT (Copia y adapta)

```
CONTEXTO: Estoy desarrollando Adaptive Huffman Compression Suite (AHCS), 
un proyecto Node.js de compresi√≥n adaptativa basada en Vitter.

ARCHIVO A CREAR: [ruta/nombre.js]

PROP√ìSITO: [explicar qu√© debe hacer]

CONVENCIONES DEL PROYECTO:
- ES6 modules (import/export)
- JSDoc para funciones p√∫blicas
- Indentaci√≥n: 2 espacios
- Usar logger para debugging
- Reutilizar: VitterEncoder, SourceAnalyzer, etc.

ESTRUCTURA REQUERIDA:
[M√©todo 1: descripci√≥n + par√°metros + retorno]
[M√©todo 2: descripci√≥n + par√°metros + retorno]

EJEMPLO DE ENTRADA:
[Ejemplo]

EJEMPLO DE SALIDA ESPERADA:
[Ejemplo]

DEPENDENCIAS EXTERNAS:
- Importar: [m√≥dulos existentes]
- Exponer: [qu√© debe exportar]

NOTAS:
- [Consideraci√≥n importante 1]
- [Consideraci√≥n importante 2]

Genera solo c√≥digo, sin explicaciones adicionales.
```

---

## EJEMPLOS DE PROMPTS ESPEC√çFICOS

### Para Controlador de Compresi√≥n:

```
CONTEXTO: Proyecto AHCS - Algoritmo Vitter implementado y testeado.

ARCHIVO: controllers/compressionController.js

PROP√ìSITO: Controlador que orquesta requests HTTP de compresi√≥n/descompresi√≥n.

M√âTODOS REQUERIDOS:
1. compress(req, res): 
   - Input: { text: string }
   - Valida que text no vac√≠o
   - Llama VitterEncoder.encode(text)
   - Llama SourceAnalyzer.calculateEntropy() y calculateFrequencies()
   - Retorna JSON con: compressed, ratio, entropy, avgCodeLength, codes, frequencies
   
2. decompress(req, res):
   - Input: { compressed: string, treeData: object }
   - Llama VitterDecoder.decode()
   - Retorna JSON con: original

REUTILIZAR:
```javascript
import VitterEncoder from '../models/VitterEncoder.js';
import VitterDecoder from '../models/VitterDecoder.js';
import SourceAnalyzer from '../models/SourceAnalyzer.js';
import logger from '../utils/logger.js';
```

FORMATO DE RESPUESTA EXITOSA:
```json
{
  "success": true,
  "data": {
    "compressed": "010101...",
    "metrics": {
      "originalSize": 88,
      "compressedSize": 26,
      "ratio": 3.38,
      "entropy": 2.18,
      "avgCodeLength": 2.36
    },
    "codes": {"A": "0", "B": "110", ...},
    "frequencies": {"A": 5, "B": 2, ...}
  }
}
```

MANEJO DE ERRORES:
- Si text.length > 1MB: return 413 + "Payload too large"
- Si VitterEncoder falla: return 400 + error message
- Log: input size, output size, tiempo

Genera solo c√≥digo funcional.
```

### Para Ruta de Compresi√≥n:

```
CONTEXTO: Backend Express.js para AHCS.

ARCHIVO: routes/compressionRoutes.js

PROP√ìSITO: Definir endpoints REST para compresi√≥n/descompresi√≥n.

ENDPOINTS REQUERIDOS:
1. POST /api/compress
   - Body: { text: string }
   - Respuesta: { success, data }
   - Limitar a 5MB

2. POST /api/decompress
   - Body: { compressed: string, treeData: object }
   - Respuesta: { success, data }

IMPORTAR Y USAR:
- express.Router()
- compressionController (m√©todos compress(), decompress())
- Middleware: express.json({ limit: '5mb' })

RESPUESTAS:
- 200: OK
- 400: Bad Request (validaci√≥n)
- 413: Payload Too Large
- 500: Server Error

Genera solo c√≥digo, sin comentarios largos.
```

### Para Frontend HTML:

```
CONTEXTO: AHCS - aplicaci√≥n de compresi√≥n Vitter.

ARCHIVO: views/index.html

PROP√ìSITO: P√°gina principal con interfaz de compresi√≥n interactiva.

SECCIONES REQUERIDAS:
1. Header: T√≠tulo + descripci√≥n breve
2. Input Section: 
   - Textarea id="inputText" para entrada
   - Bot√≥n id="compressBtn" para comprimir
3. Results (inicialmente hidden):
   - Metrics grid: originalSize, compressedSize, ratio, entropy, avgLength, shannon
   - Codes table: s√≠mbolo, frecuencia, c√≥digo, longitud
   - Tree visualization: div id="treeVisualization"
   
REQUISITOS:
- Semantic HTML5
- Responsive (mobile-first)
- IDs para elementos que JS manipular√°
- CSS classes descriptivas (no inline styles)
- Accesibilidad: labels, alt text

INTEGRACI√ìN:
- Cargar D3.js desde CDN
- Script src="/js/main.js" (defer)

Estructura simple, una p√°gina, sin frameworks.
```

### Para JavaScript Cliente:

```
CONTEXTO: AHCS frontend - conectar con backend Vitter.

ARCHIVO: public/js/main.js

PROP√ìSITO: L√≥gica principal de interacci√≥n usuario ‚Üí API.

FUNCIONALIDADES:
1. Event: Click compressBtn ‚Üí validar ‚Üí fetch POST /api/compress
2. Parsear respuesta JSON
3. Actualizar DOM: metrics, tabla c√≥digos, √°rbol
4. Manejo de errores: mostrar alert si falla

FUNCIONES REQUERIDAS:
- handleCompress(): Evento click, valida input, llama API
- updateMetrics(data): Rellena div de m√©tricas
- updateCodesTable(codes, frequencies): Rellena tabla
- handleError(error): Muestra error en UI

PAR√ÅMETROS API:
- POST /api/compress: { text: string }
- Respuesta: { success, data: { metrics, codes, frequencies, compressed } }

VALIDACIONES:
- Text no vac√≠o
- Max 1MB

Usa vanilla JS, sin jQuery.
```

### Para CSS:

```
CONTEXTO: AHCS - estilos profesionales y responsivos.

ARCHIVO: public/css/styles.css

PROP√ìSITO: Dise√±o completo de interfaz.

SECCIONES A ESTILIZAR:
1. Body/General: fuente, colores base, background
2. Header: t√≠tulo, descripci√≥n
3. Input Section: textarea, bot√≥n
4. Metrics Grid: 6 cards, colores diferenciados (highlight ratio)
5. Codes Table: border-collapse, striped rows
6. Tree Container: altura 600px, scroll si necesario
7. Responsive: mobile (<768px) stack vertical

VARIABLES CSS:
--primary: #4dabf7 (azul)
--success: #51cf66 (verde)
--error: #ff6b6b (rojo)
--text: #222
--bg: #f8f9fa

ANIMACIONES:
- Button hover: scale 1.02
- Results aparecer: fade-in 0.3s

Mobile-first, sin Bootstrap.
```

---

## PROMPT FINAL PARA TODA UNA FASE

Si quieres generar m√∫ltiples archivos de una fase:

```
FASE: Backend API (compressionController + compressionRoutes + appConfig)

CONTEXTO: AHCS - Algoritmo Vitter listo, necesito exponer v√≠a HTTP REST.

MODELOS DISPONIBLES:
- VitterEncoder: .encode(text) ‚Üí { compressed, tree, originalSize, compressedSize, ratio }
- VitterDecoder: .decode(compressed, treeData) ‚Üí string
- SourceAnalyzer: .calculateEntropy(frequencies), .calculateFrequencies(text)

ARCHIVOS A GENERAR:

1. config/appConfig.js
   - Export: puerto (3000), maxBodySize (5MB), corsOrigin ('*')

2. controllers/compressionController.js
   - M√©todos: compress(req, res), decompress(req, res)
   - Ver detalles en template anterior

3. routes/compressionRoutes.js
   - POST /api/compress
   - POST /api/decompress
   - Ver template anterior

INTEGRACI√ìN:
- app.js luego importar√°: compressionRoutes, appConfig
- Frontend luego llamar√°: POST /api/compress

Genera en orden, c√≥digo limpio, sin explicaciones.
```

---

## CHECKLIST ANTES DE PEDIR C√ìDIGO A COPILOT

‚úÖ ¬øTengo claro el prop√≥sito del archivo?
‚úÖ ¬øConozco sus dependencias con otros m√≥dulos?
‚úÖ ¬øS√© qu√© debe exportar?
‚úÖ ¬øTengo ejemplos de input/output?
‚úÖ ¬øUsar√© modules ES6?
‚úÖ ¬øReutilizar√© c√≥digo existente (no reimplementar)?
‚úÖ ¬øSeguir√© convenciones del proyecto?

Si respondiste "no" a algo ‚Üí **Define eso primero en el prompt**

---

## CIERRE: INSTRUCCI√ìN FINAL PARA COPILOT

Incluye esto al final de CUALQUIER prompt:

```
INSTRUCCIONES FINALES:
1. C√≥digo limpio, profesional, production-ready
2. Sin explicaciones: solo c√≥digo + comentarios t√©cnicos
3. Completo: no dejes TODOs ni placeholders
4. Testeado mentalmente: aunque sea, valida l√≥gica
5. Sigue EXACTAMENTE las convenciones mencionadas
6. Si hay ambig√ºedad: elige la opci√≥n m√°s simple
7. NO agregues features extras no pedidas
8. Formato: c√≥digo puro, no markdown code blocks si es posible
```

---

## TEMPLATE R√ÅPIDO (Copiar y pegar)

```
PROYECTO: AHCS (Adaptive Huffman Compression Suite)
ARCHIVO: [RUTA/ARCHIVO.js]
PROP√ìSITO: [QU√â DEBE HACER]
CONVENCIONES: ES6 modules, 2 espacios indent, JSDoc, reutilizar modelos
M√âTODOS: [LISTA DE M√âTODOS CON PAR√ÅMETROS Y RETORNO]
EJEMPLO DE SALIDA: [FORMATO JSON O ESTRUCTURA]
DEPENDENCIAS: [QU√â IMPORTAR]
NOTAS: [CONSIDERACIONES ESPECIALES]
Genera solo c√≥digo.
```

C√≥pialo, adapta los campos, y pasa a Copilot. ‚úÖ
